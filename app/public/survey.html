<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

    <title>Fellowship Finder</title>
  </head>
  <body>

    <div class="container">

        <br>
        <h1>Fellowship Finder</h1>

        <hr>

        <br>
        <h2>Survey Questions</h2>

        <hr>

        <form>

            <br>
            <h3><strong>About You</strong></h3>
            <br>
            <h4>Name (Required)</h4>
            <input type="text" id="name" class="form-control" required="">
            <br>
            <h4>Link to Photo Image (Required)</h4>
            <input type="text" id="photo" class="form-control" required="">
            <br>

            <hr>

            <br>
            <h3><strong>Question 1</strong></h3>
            <h4>You have an insatiable desire for adventure.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q1"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 2</strong></h3>
            <h4>You prefer dwarven ale to elven wine.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q2"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 3</strong></h3>
            <h4>Charging head first into battle is the best way to finish a quest.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q3"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 4</strong></h3>
            <h4>######</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q4"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 5</strong></h3>
            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q5"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 6</strong></h3>
            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q6"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 7</strong></h3>
            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q7"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 8</strong></h3>
            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q8"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 9</strong></h3>
            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q9"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <h3><strong>Question 10</strong></h3>
            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
            <div class="slidecontainer">
                <h5 class='d-inline mr-3'>Nay</h5><input type="range" min="1" max="5" value="3" class="slider" id="q10"><h5 class='d-inline ml-3'>Aye</h5>
            </div>
            <br>

            <br>
            <!-- Submit Button -->
            <button type="submit" class="btn btn-success btn-lg btn-block" id="submit">Submit</button>
            <br>

        </form>
    
        <hr>
        
        <footer class="footer">
        <div class="container">
            <p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/morrowii/fellowship-finder">GitHub Repo</a></p>
        </div>
        </footer>
    
    </div>
    
    <div class="modal" id='myModal' tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Best Match</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body d-flex flex-column">
                    <h4 class='modal-name mx-auto'></h5>
                    <img src='' crossorigin="anonymous" class='modal-photo mx-auto'>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom CSS -->
    <style>

    .slidecontainer {
        margin-top: 20px;
    }
    
    .slider {
        -webkit-appearance: none;
        width: 50%;
        height: 15px;
        border-radius: 5px;   
        background: #d3d3d3;
        outline: none;
        opacity: 0.7;
        -webkit-transition: .2s;
        transition: opacity .2s;
    }

    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 25px;
        height: 25px;
        border-radius: 50%; 
        background: #4CAF50;
        cursor: pointer;
    }

    .slider::-moz-range-thumb {
        width: 25px;
        height: 25px;
        border-radius: 50%;
        background: #4CAF50;
        cursor: pointer;
    }
    
    </style>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>

        <!-- Custom JS -->
        <script>
        
            $("#submit").on("click", function(event) {
                event.preventDefault();
        
                // Validate form inputs
                function validateForm() {
                    var isValid = true;
                    $("input").each(function() {
                        if ($(this).val() === "") {
                            isValid = false;
                        }
                    });
                    return isValid;
                }
            
                // If user completed all inputs
                if (validateForm()) {
                    // Create object with user data
                    var userData = {
                        name: $("#name").val(),
                        photo: $("#photo").val(),
                        scores: [
                            $("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                        ]
                    };

                    console.log(userData);
            
                    // Post user data to friends API with AJAX
                    $.post("/api/friends", userData, function(data) {
            
                        // Display the name and photo of the user's match from the response data
                        $('.modal-name').text(data.name);
                        $('.modal-photo').attr("src", data.photo);
                
                        // Show the modal with the best match
                        $("#myModal").modal("toggle");
            
                    });
                } else {
                    alert("Make sure you complete the survey before submitting!");
                }
            });
        </script>

  </body>
</html>